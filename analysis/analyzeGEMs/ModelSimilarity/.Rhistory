dProb[i,j] <- predict(RFres,dat[i,1:(ncol(dat)-1)],type="prob")[,1]
impProbeSetIDs <- rbind(impProbeSetIDs,
rownames(RFres$importance)[order(RFres$importance,decreasing=T)][1:10])
}
pred   <- prediction(dProb[,j],as.numeric(dat[,ncol(dat)]==1))
auc[j] <- performance(pred,measure="auc")@y.values[[1]]
}
sort(coef.min)
index.min
rxns.eq.sel <- rownames(coef.min)[active.min[order(abs(index.min),decreasing = T)]][-1] #Remove "Intercept"
rxns.eq.sel
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel,
clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = NA,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
head(active.min)
head(row.names(coef.min))
rxns.eq.sel <- rownames(coef.min)[active.min][-1] #Remove "Intercept"
head(rxns.eq.sel)
rxns.eq.sel <- rownames(coef.min)[active.min]
head(rxns.eq.sel)
out.cv2     <- cv.glmnet(rxnInclMat.clust3k.sel,class1or3,parallel = T,
family = "binomial", nfolds=20)
rxnInclMat.class1or3.sel <- t(rxnInclMat[rxns.eq.sel,model.class!=2])
out.cv2     <- cv.glmnet(rxnInclMat.class1or3.sel,class1or3,parallel = T,
family = "binomial", nfolds=20)
head(rxnInclMat.class1or3.sel)
any(is.na(rxnInclMat.class1or3.sel))
rxns.eq.sel <- rownames(coef.min)[active.min][-1] #Remove "Intercept"
rxnInclMat.class1or3.sel <- t(rxnInclMat[rxns.eq.sel,model.class!=2])
out.cv2     <- cv.glmnet(rxnInclMat.class1or3.sel,class1or3,parallel = T,
family = "binomial", nfolds=20)
coef.min2    <- coef(out.cv2, s = "lambda.1se")
coef.min2
plot(out.cv2)
coef.min    <- coef(out.cv, s = "lambda.min")
active.min  <- which(coef.min != 0)
coef.min2    <- coef(out.cv, s = "lambda.min")
active.min2  <- which(coef.min2 != 0)
index.min2   <- coef.min2[active.min2]
rxns.eq.sel2 <- rownames(coef.min2)[active.min2][-1] #Remove "Intercept"
rxns.eq.sel2
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel2,
clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = NA,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
coef.min    <- coef(out.cv, s = "lambda.1se")
active.min  <- which(coef.min != 0)
index.min   <- coef.min[active.min]
rxns.eq.sel <- rownames(coef.min)[active.min][-1] #Remove "Intercept"
rxnInclMat.class1or3.sel <- t(rxnInclMat[rxns.eq.sel,model.class!=2])
head(rxnInclMat.clust3k.sel)
wilcox.test(rxnInclMat.clust3k.sel~class1or3)
wilcox.test(rxnInclMat.clust3k.sel[1,]~class1or3)
rxnInclMat.clust3k.sel[1,]
wilcox.test(as.vector(rxnInclMat.clust3k.sel[1,])~class1or3)
wilcox.test(as.numeric(rxnInclMat.clust3k.sel[1,])~class1or3)
wilcox.test(as.numeric(rxnInclMat.class1or3.sel[1,])~class1or3)
as.numeric(rxnInclMat.class1or3.sel[1,])
as.numeric(rxnInclMat.class1or3.sel[,1])
wilcox.test(as.numeric(rxnInclMat.class1or3.sel[,1])~class1or3)
a<-wilcox.test(as.numeric(rxnInclMat.class1or3.sel[,1])~class1or3)
a$p.value
wilcox      <- matrix(0,ncol=1,nrow=ncol(rxnInclMat.class1or3.sel),
dimnames=list(colnames(rxnInclMat.class1or3.sel),"WilcoxP"))
for (rxn in colnames(rxnInclMat.class1or3.sel)){
res <- wilcox.test(as.numeric(rxnInclMat.class1or3.sel[,rxn])~class1or3)
wilcox[,rxn] <- res$p.value
}
res$p.value
head(wilcox)
wilcox      <- matrix(0,ncol=1,nrow=ncol(rxnInclMat.class1or3.sel),
dimnames=list(colnames(rxnInclMat.class1or3.sel),"WilcoxP"))
for (rxn in colnames(rxnInclMat.class1or3.sel)){
res <- wilcox.test(as.numeric(rxnInclMat.class1or3.sel[,rxn])~class1or3)
wilcox[rxn,] <- res$p.value
}
wilcox
sort(wilcox)
wilcox[order(wilcox),]
wilcox < 0.01
rxns.eq.sel2 <- rownames(wilcox)[wilcox<0.01]
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel2,
clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = NA,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
wilcox <- p.adjust(wilcox,method = "fdr")
rxns.eq.sel2 <- rownames(wilcox)[wilcox<0.01]
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel2,
clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = NA,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
wilcox
wilcox[,1] <- p.adjust(wilcox,method = "fdr")
wilcox      <- matrix(0,ncol=1,nrow=ncol(rxnInclMat.class1or3.sel),
dimnames=list(colnames(rxnInclMat.class1or3.sel),"WilcoxP"))
for (rxn in colnames(rxnInclMat.class1or3.sel)){
res <- wilcox.test(as.numeric(rxnInclMat.class1or3.sel[,rxn])~class1or3)
wilcox[rxn,] <- res$p.value
}
wilcox[,1] <- p.adjust(wilcox,method = "fdr")
rxns.eq.sel2 <- rownames(wilcox)[wilcox<0.01]
wilcox
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel2,
clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = NA,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
###Retrieve significantly different rxns and cluster
rxns.eq.sel2 <- rownames(wilcox)[wilcox<0.01]
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel2,
clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = NA,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
HMR2.rxnTable <- read.delim("../../docs/cHMR3765_rxnTable.txt")
head(HMR2.rxnTable)
rxns.eq.sel2.id <- HMR2.rxnTable$RxnID[match(rxns.eq.sel2,HMR2.rxnTable$Eq)]
rxns.eq.sel2
rxns.eq.sel2.id
rownames(HMR2.rxnTable) <- HMR2.rxnTable$RxnID
HMR2.rxnTable[head(rxns.eq.sel2.id),]
rxns.eq.sel2.id <- HMR2.rxnTable$RxnID[match(HMR2.rxnTable$Eq,rxns.eq.sel2)]
HMR2.rxnTable[head(rxns.eq.sel2.id),]
rxns.eq.sel2.id
rxns.eq.sel2.id <- HMR2.rxnTable$RxnID[match(rxns.eq.sel2,HMR2.rxnTable$Eq)]
rxns.eq.sel2 <- rownames(wilcox)[wilcox<0.01]
head(rxns.eq.sel2)
match(rxns.eq.sel2,HMR2.rxnTable$Eq)
a<-match(rxns.eq.sel2,HMR2.rxnTable$Eq)
HMR2.rxnTable[a,]
HMR2.gpr  <- read.delim("../../docs/cHMR3765_rxnGeneMatrix.txt")
rownames(HMR2.gpr)<-HMR2.gpr[,1]
HMR2.gpr <- HMR2.gpr[,-c(1,ncol(HMR2.gpr))]
head(HMR2.gpr)
rxns.table.sel2 <- HMR2.rxnTable[match(rxns.eq.sel2,HMR2.rxnTable$Eq),]
head(rxns.table.sel2)
apply(HMR2.gpr[rxns.table.sel2$RxnID,],2,sum)>0
genes.sel2      <- colnames(which(apply(HMR2.gpr[rxns.table.sel2$RxnID,],2,sum)>0)
)
genes.sel2      <- colnames(which(apply(
HMR2.gpr[rxns.table.sel2$RxnID,],2,sum)>0))
genes.sel2
genes.sel2      <- colnames(HMR2.gpr)[which(apply(
HMR2.gpr[rxns.table.sel2$RxnID,],2,sum)>0)]
genes.sel2      <- colnames(HMR2.gpr)[which(apply(
genes.sel2
load("../../data/annotation.RData")
a <- annotEntrez[annotEntrez$ensembl_gene_id %in% genes.sel2,]
a
sort(apply(
HMR2.gpr[rxns.table.sel2$RxnID,],2,sum))
rxns.table.sel2
min(HMR2.gpr)
max(HMR2.gpr)
any(HMR2.gpr>0 & HMR2.gpr<1)
any(HMR2.gpr>0 & HMR2.gpr==1)
a<-HMR2.gpr["HMR_7919",]
a[,a!=0]
which(a!=0)
HMR2.gpr["HMR_7919",1762]
colnames(HMR2.gpr["HMR_7919",1762])
colnames(HMR2.gpr[,1762])
colnames(HMR2.gpr[,1762:1763])
genes.sel2
genes.sel2      <- colnames(HMR2.gpr)[which(apply(
HMR2.gpr[rxns.table.sel2$RxnID,],1,sum)>0)]
genes.sel2
HMR2.gpr[rxns.table.sel2$RxnID,1762:1763]
genes.sel2      <- colnames(HMR2.gpr)[which(apply(
HMR2.gpr[match(rxns.table.sel2$RxnID,rownames(HMR2.gpr))
,],1,sum)>0)]
genes.sel2
genes.sel2      <- colnames(HMR2.gpr)[which(apply(
HMR2.gpr[match(rxns.table.sel2$RxnID,rownames(HMR2.gpr))
,],2,sum)>0)]
genes.sel2
a <- annotEntrez[annotEntrez$ensembl_gene_id %in% genes.sel2,]
a
y.class1or3 <-  y[,match(gsub(pattern=".",replacement="-",x=colnames(rxnInclMat.clust3k.sel)),rownames(y$samples))]
head(y.class1or3$samples)
b <- gsub(pattern=".",replacement="-",x=colnames(rxnInclMat.clust3k.sel))
head(b)
head(colnames(rxnInclMat.clust3k.sel))
b <- gsub(pattern="\\.",replacement="\\-",x=colnames(rxnInclMat.clust3k.sel))
head(b)
y.class1or3 <-  y[,match(gsub(pattern="\\.",replacement="\\-",x=colnames(rxnInclMat.clust3k.sel)),rownames(y$samples))]
head(y.class1or3$samples)
rxnInclMat.class1or3[1:5,1:3]
y.class1or3 <-  y[match(gsub(pattern="\\.",replacement="\\-",x=colnames(rxnInclMat.clust3k.sel)),rownames(y$samples)),]
head(y.class1or3$samples)
dim(y.class1or3$samples)
head(y.class1or3$counts)
y.class1or3$counts[1:5,1:2]
rxnInclMat.class1or3[1:5,1:3]
PSID.class1or3  <-gsub(pattern="\\.",replacement="\\-",
x=colnames(rxnInclMat.class1or3))
PSID.class1or3
PSID.class1or3  <-gsub(pattern="\\.",replacement="\\-",
x=rownames(rxnInclMat.class1or3))
PSID.class1or3  <-gsub(pattern="\\.",replacement="\\-",
x=rownames(rxnInclMat.class1or3))
PSID.class1or3
all(PSID.class1or3%in%rownames(y$sample))
match(PSID.class1or3,rownames(y$sample))
str(y)
lib.size   <- with(y$samples, lib.size * norm.factors)
E          <- t(log2(t(y$counts + 0.5)/(lib.size + 1) * 1e+06))
E[1:5,1:2]
E.class1or3 <- E[,match(PSID.class1or3,colnames(E))]
genes.sel2.entz <- rownames(annotEntrez[annotEntrez$ensembl_gene_id
%in% genes.sel2,])
genes.sel2.entz
E.class1or3.sel2 <- E.class1or3[genes.sel2.entz,]
which(genes.sel2.entz%in%y$genes)
head(y$genes)
which(genes.sel2.entz%in%rownames(y$genes))
all(genes.sel2.entz%in%rownames(y$genes))
which(!genes.sel2.entz%in%rownames(y$genes))
genes.sel2[12]
E.class1or3.sel2 <- E.class1or3[genes.sel2.entz[genes.sel2.entz%in%rownames(E.class1or3)],]
head(E.class1or3.sel2)
cbind(colnames(E.class1or3.sel2),class1or3)
head(model.class)
tail(model.class)
c<-cbind(colnames(E.class1or3.sel2),class1or3)
head(c)
for (gene in rownames(E.class1or3.sel2)){
boxplot(E.class1or3.sel2[gene,]~class1or3)
}
heatmap.2(E.class1or3.sel2)
heatmap.2(E.class1or3.sel2,trace="none")
heatmap.2(E.class1or3.sel2,trace="none",scale = "none",col=hmcols)
heatmap.2(E.class1or3.sel2,trace="none",scale = "none",col=hmcols,)
heatmap.2(E.class1or3.sel2,trace="none",scale = "none",col=hmcols,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"])
?heatmap.2
heatmap.2(E.class1or3.sel2,trace="none",scale = "none",col=hmcols,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=class1or3)
class1or3
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
heatmap.2(E.class1or3.sel2,trace="none",scale = "none",col=hmcols,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
head(class1or3)
class1or3
model.class
names(class1or3)     <- names(model.class[model.class!=2])
head(class1or3)
PSID.class1or3   <- gsub(pattern="\\.",replacement="\\-",
x=names(class1or3))
lib.size         <- with(y$samples, lib.size * norm.factors)
E                <- t(log2(t(y$counts + 0.5)/(lib.size + 1) * 1e+06))
E.class1or3      <- E[,match(PSID.class1or3,colnames(E))]
E.class1or3.sel2 <- E.class1or3[genes.sel2.entz[genes.sel2.entz%in%rownames(E.class1or3)],]
for (gene in rownames(E.class1or3.sel2)){
boxplot(E.class1or3.sel2[gene,]~class1or3)
}
hm <- heatmap.2(E.class1or3.sel2,trace="none",scale = "none",col=hmcols,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel2,]
#                                     clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = NA,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = T,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
rxnInclMat.clust3k.sel <- rxnInclMat[rxns.eq.sel2,
clust3k$consensusTree$order]
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = T,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
hm          <- heatmap.2(as.matrix(rxnInclMat.clust3k.sel),
Rowv = NA,Colv = F,symm = F,scale="none",
col=c("White","Black"),density.info="none",
trace="none",labCol=NA)
#What are the genes beyond the rxns that make class 1 and 3 different?
rxns.table.sel2  <- HMR2.rxnTable[match(rxns.eq.sel2,HMR2.rxnTable$Eq),]
head(rxns.table.sel2)
genes.sel2       <- colnames(HMR2.gpr)[which(apply(
HMR2.gpr[match(rxns.table.sel2$RxnID,rownames(HMR2.gpr))
,],2,sum)>0)]
genes.sel2
annotEntrez[annotEntrez$ensembl_gene_id
%in% genes.sel2,]
v.fit <- voom(E.class1or3,class1or3)
v.fit <- voom(E.class1or3,model.matrix(~class1or3))
y.class1or3 <- y[,rownames(y$samples)%in%PSID.class1or3]
str(y.class1or3)
v.fit <- voom(y.class1or3,class1or3)
v.fit <- voom(y.class1or3,model.matrix(~class1or3))
v.fit <- voom(y.class1or3,model.matrix(~class1or3),plot=T)
lm.fit <- lmFit(v.fit,model.matrix(~class1or3))
eB <- eBayes(lm.fit)
tT <- topTable(eB)
tT
tT <- topTable(eB,number = Inf)
tT[11:20,]
writeLines(tT$hgnc_symbol[tT$adj.P.Val<0.05,])
writeLines(tT$hgnc_symbol[tT$adj.P.Val<0.05])
writeLines(tT$hgnc_symbol[tT$adj.P.Val<0.05],con = "signgenes_class1vs3.txt")
genes.sel2
geneIncMatFile <- c("../geneInclMat.txt")#,"../geneInclMat.txt","../metInclMat.txt")
geneInclMat        <- read.delim(geneIncMatFile,header=T,sep="\t",row.names=1,allowEscapes=T)
geneInclMat        <- geneInclMat[,-grep("X.1",colnames(geneInclMat))]
lib.size         <- with(y$samples, lib.size * norm.factors)
E                <- t(log2(t(y$counts + 0.5)/(lib.size + 1) * 1e+06))
E.ensg            <- E
colnames(E.ensg)  <- gsub(pattern="-",replacement=".",x=colnames(E.ensg))
rownames(E.ensg)  <- annotEntrez[rownames(E),"ensembl_gene_id"]
genes.ensg.common <- intersect(rownames(E.ensg),rownames(geneInclMat))
geneInclMat.c     <- geneInclMat[genes.ensg.common,]
E.ensg.c          <- E.ensg[genes.ensg.common,]
head(E.ensg.c)
E.class1or3[genes.sel2,]
E.class1or3.sel2 <- E.class1or3[genes.sel2[genes.sel2%in%rownames(E.class1or3)],]
E.class1or3      <- E.ensg.c[,match(PSID.class1or3,colnames(E.ensg.c))]
E.class1or3.sel2 <- E.class1or3[genes.sel2[genes.sel2%in%rownames(E.class1or3)],]
E.class1or3      <- E.ensg.c[,match(PSID.class1or3,colnames(E.ensg.c))]
head(E.ensg.c)
PSID.class1or3   <- names(class1or3))
E.class1or3      <- E.ensg.c[,match(PSID.class1or3,colnames(E.ensg.c))]
E.class1or3.sel2 <- E.class1or3[genes.sel2[genes.sel2%in%rownames(E.class1or3)],]
PSID.class1or3   <- names(class1or3)
E.class1or3      <- E.ensg.c[,match(PSID.class1or3,colnames(E.ensg.c))]
head(E.ensg.c)
head(E.class1or3.sel2
)
E.class1or3      <- E.ensg.c[,match(PSID.class1or3,colnames(E.ensg.c))]
E.class1or3.sel2 <- E.class1or3[genes.sel2[genes.sel2%in%rownames(E.class1or3)],]
head(E.class1or3.sel2)
for (gene in rownames(E.class1or3.sel2)){
boxplot(E.class1or3.sel2[gene,]~class1or3)
}
head(geneInclMat.c)
geneInclMat.class1or3 <- geneInclMat.c[,match(PSID.class1or3,colnames(geneInclMat.c))]
head(geneInclMat.class1or3)
geneInclMat.class1or3.sel2 <- geneInclMat.class1or3[genes.sel2[genes.sel2%in%rownames(E.class1or3)],]
for (gene in rownames(geneInclMat.class1or3.sel2)){
boxplot(geneInclMat.class1or3.sel2[gene,]~class1or3)
}
head(geneInclMat.class1or3.sel2)
geneInclMat.class1or3.sel2[1,]
for (gene in rownames(geneInclMat.class1or3.sel2)){
boxplot(geneInclMat.class1or3.sel2[gene,]~class1or3)
}
for (g in rownames(geneInclMat.class1or3.sel2)){
boxplot(geneInclMat.class1or3.sel2[g,]~class1or3)
}
rownames(geneInclMat.class1or3.sel2)
g
geneInclMat.class1or3.sel2[g,]
a<-geneInclMat.class1or3.sel2[g,]
boxplot(a~class1or3)
class(a)
for (g in rownames(geneInclMat.class1or3.sel2)){
boxplot(as.numeric(geneInclMat.class1or3.sel2[g,])~class1or3)
}
?barplot
hm <- heatmap.2(geneInclMat.class1or3.sel2,trace="none",scale = "none",col=hmcols,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
hm <- heatmap.2(as.matrix(geneInclMat.class1or3.sel2),trace="none",scale = "none",col=hmcols,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
hm <- heatmap.2(as.matrix(geneInclMat.class1or3.sel2),trace="none",
scale = "none",col=c("White","Black"),Rowv=F,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
hm <- heatmap.2(as.matrix(geneInclMat.class1or3.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=F,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
geneInclMat.sel2 <- geneInclMat.c[genes.sel2[genes.sel2%in%rownames(geneInclMat.c)],]
hm <- heatmap.2(as.matrix(geneInclMat.class1or3.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=F,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
clust3k$consensusTree$order
length(clust3k$consensusTree$order)
max(clust3k$consensusTree$order)
min(clust3k$consensusTree$order)
hm <- heatmap.2(as.matrix(geneInclMat.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=F,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(class1or3))
hm <- heatmap.2(as.matrix(geneInclMat.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=F,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],ColSideColors=as.character(model.class))
hm <- heatmap.2(as.matrix(geneInclMat.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=F,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
hm <- heatmap.2(as.matrix(geneInclMat.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=T,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
colnames(E.ensg.c)
E.ensg.c          <- E.ensg[genes.ensg.common,PSID.m]
PSID.m       <- colnames(rxnInclMat)
E.ensg.c          <- E.ensg[genes.ensg.common,PSID.m]
rxnInclMat[1:5,1:3]
E.ensg.c[1:5,1:3]
E.sel2 <- E.ensg.c[genes.sel2[genes.sel2%in%rownames(E.ensg.c)],]
hm <- heatmap.2(E.sel2,trace="none",scale = "none",col=hmcols,
Rowv=T,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(class1or3))
E.sel2 <- E.ensg.c[genes.sel2[genes.sel2%in%rownames(E.ensg.c)],]
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",scale = "none",col=hmcols,
Rowv=T,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
?heatmap.2
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "row",
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
par(mfrow=c(2,1))
geneInclMat.sel2 <- geneInclMat.c[genes.sel2[genes.sel2%in%rownames(geneInclMat.c)],]
hm <- heatmap.2(as.matrix(geneInclMat.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=T,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
E.sel2 <- E.ensg.c[genes.sel2[genes.sel2%in%rownames(E.ensg.c)],]
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
par(mfrow=c(1,1))
geneInclMat.sel2 <- geneInclMat.c[genes.sel2[genes.sel2%in%rownames(geneInclMat.c)],]
hm <- heatmap.2(as.matrix(geneInclMat.sel2[,clust3k$consensusTree$order]),
trace="none",
scale = "none",col=c("White","Black"),Rowv=T,Colv=F,symm=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
E.sel2 <- E.ensg.c[genes.sel2[genes.sel2%in%rownames(E.ensg.c)],]
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
head(tT)
genes.DE.class1or3 <- tT$ensembl_gene_id[tT$adj.P.Val < 0.05]
genes.DE.class1or3.hgnc <- tT$hgnc_symbol[tT$adj.P.Val < 0.05]
E.sel3      <- E.ensg.c[genes.DE.class1or3[genes.DE.class1or3%in%rownames(E.ensg.c)],]
hm <- heatmap.2(E.sel3[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",
labCol=NA,labRow=genes.DE.class1or3.hgnc,
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
genes.DE.class1or3.hgnc
hm <- heatmap.2(E.sel3[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",
labCol=NA,labRow=genes.DE.class1or3.hgnc[genes.DE.class1or3.ensg%in%rownames(E.ensg.c)],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
genes.DE.class1or3.ensg <- tT$ensembl_gene_id[tT$adj.P.Val < 0.05]
genes.DE.class1or3.hgnc <- tT$hgnc_symbol[tT$adj.P.Val < 0.05]
E.sel3      <- E.ensg.c[genes.DE.class1or3.ensg
[genes.DE.class1or3.ensg%in%rownames(E.ensg.c)],]
hm <- heatmap.2(E.sel3[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",
labCol=NA,labRow=genes.DE.class1or3.hgnc[genes.DE.class1or3.ensg%in%rownames(E.ensg.c)],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
model.matrix(~class1or3)
head(tT)
boxplot(E.sel3~class1or3)
boxplot(E.sel3[1,]~class1or3)
boxplot(E.sel3[1,]~model.class)
?heatmap.2
hm <- heatmap.2(E.sel3[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",symbreaks=F,
labCol=NA,labRow=genes.DE.class1or3.hgnc[genes.DE.class1or3.ensg%in%rownames(E.ensg.c)],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",symbreaks=F,
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
hmcols
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",symbreaks=F,breaks=seq(0,10,10/length(hmcols)),
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",symbreaks=F,breaks=seq(-1,10,10/length(hmcols)),
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",symbreaks=F,breaks=seq(-1,10,11/length(hmcols)),
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
hm <- heatmap.2(E.sel2[,clust3k$consensusTree$order],trace="none",col=hmcols,
Rowv=T,Colv=F,symm=F,scale = "none",symbreaks=F,
breaks=seq(-2,10,12/length(hmcols)),
labCol=NA,labRow=annotEntrez[genes.sel2.entz,"hgnc_symbol"],
ColSideColors=as.character(model.class[clust3k$consensusTree$order]))
